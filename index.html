<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahjong Pyramid Inventory Neon Pro</title>
<style>
body { margin:0; font-family: Arial,sans-serif; background:#0b0c10; color:#fff; display:flex; flex-direction:column; align-items:center; }
#menu, #game { width:95vw; max-width:1200px; text-align:center; }
#menu button { margin:10px; padding:1em 2em; font-size:1.2em; border:none; border-radius:8px; background:#222; color:#fff; cursor:pointer; transition:0.3s; }
#menu button:hover { background:#00f0ff; color:#000; }
.board { position:relative; margin-top:20px; width:95vw; max-width:1200px; aspect-ratio:1/1; }
.tile { position:absolute; border-radius:8px; display:flex; justify-content:center; align-items:center; cursor:pointer; transition:all 0.3s ease; transform-style:preserve-3d; }
.tile img { width:80%; height:80%; object-fit:contain; }
.tile.flippable:hover { transform: scale(1.1); box-shadow:0 0 20px #0ff,0 0 40px #ff0,0 0 60px #f0f; }
.tile.flipped { transform:rotateY(180deg); }
#inventory { display:flex; justify-content:center; gap:10px; margin-top:20px; }
.slot { width:60px; height:60px; background:#111; border:3px solid #0ff; border-radius:8px; display:flex; justify-content:center; align-items:center; }
.slot img { width:80%; height:80%; object-fit:contain; }
#score { margin-top:20px; font-size:1.5em; }
</style>
</head>
<body>
<div id="menu">
<h1>Mahjong Pyramid Inventory Neon Pro</h1>
<p>Wybierz poziom trudności:</p>
<button data-level="record">Rekordowy</button>
<button data-level="pro">Zawodowy</button>
<button data-level="extreme">Ekstremalny</button>
<button data-level="hard">Trudny</button>
<button data-level="medium">Średni</button>
<button data-level="classic">Klasyczny losowy</button>
<button data-level="easy">Łatwy</button>
</div>
<div id="game" style="display:none;">
<div id="score">Score: 0</div>
<div class="board" id="board"></div>
<div id="inventory">
<div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div>
</div>
</div>
<script>
const levelLayers = {
  record:[8,7,6,5,4,3],
  pro:[7,6,5,4,3],
  extreme:[6,5,4,3],
  hard:[5,4,3,2],
  medium:[4,3,2],
  classic:[], // losowe warstwy
  easy:[3,2]
};
const baseColors=['#ff073a','#00f0ff','#ffff00','#00ff3c','#ff00f0','#ff7f00','#00ffff','#7fff00'];
let symbols=[], inventory=[], score=0;
const boardEl=document.getElementById('board');
const inventoryEls=document.querySelectorAll('.slot');
const scoreEl=document.getElementById('score');

// Menu start
document.querySelectorAll('#menu button').forEach(btn=>{
  btn.addEventListener('click',()=>{
    startGame(btn.dataset.level);
    document.getElementById('menu').style.display='none';
    document.getElementById('game').style.display='block';
  });
});

function startGame(level){
  inventory=[]; score=0; scoreEl.innerText='Score: 0'; boardEl.innerHTML=''; inventoryEls.forEach(slot=>slot.innerHTML='');
  let layers=levelLayers[level];
  if(level==='classic'){
    const numLayers=Math.floor(Math.random()*3)+2;
    layers=[];
    for(let i=0;i<numLayers;i++) layers.push(Math.floor(Math.random()*5)+2);
  }
  let pairs=[];
  let colorIndex=0;
  layers.forEach(layerSize=>{
    for(let i=0;i<layerSize*layerSize/2;i++){
      const color=baseColors[colorIndex%baseColors.length]; colorIndex++;
      pairs.push({id:i,color:color,img:`assets/images/${i+1}.png`}, {id:i,color:color,img:`assets/images/${i+1}.png`});
    }
  });
  pairs.sort(()=>Math.random()-0.5);

  // Piramida kwadratowa dynamiczna
  let idx=0;
  const boardWidth=boardEl.clientWidth;
  const boardHeight=boardEl.clientHeight;
  const maxLayerSize=Math.max(...layers);
  const tileSize=Math.floor(boardWidth/(maxLayerSize+1));
  layers.forEach((layerSize,layerIndex)=>{
    const offsetX=(boardWidth - layerSize*tileSize)/2;
    const offsetY=layerIndex*tileSize/2;
    for(let r=0;r<layerSize;r++){
      for(let c=0;c<layerSize;c++){
        if(idx>=pairs.length) break;
        const p=pairs[idx];
        const tile=document.createElement('div');
        tile.classList.add('tile','flippable');
        tile.style.width=tile.style.height=tileSize+'px';
        tile.style.left=(c*tileSize + offsetX)+'px';
        tile.style.top=(r*tileSize/1.2 + offsetY)+'px';
        tile.style.border=`3px solid ${p.color}`;
        tile.dataset.id=p.id; tile.dataset.color=p.color;
        tile.innerHTML=`<img src='${p.img}'>`;
        tile.addEventListener('click',()=>pickTile(tile));
        boardEl.appendChild(tile);
        idx++;
      }
    }
  });
}

function pickTile(tile){
  if(inventory.length>=4){ alert('Ekwipunek pełny! Gra resetuje się.'); startGame('record'); return; }
  tile.style.visibility='hidden';
  const slot=inventoryEls[inventory.length];
  slot.innerHTML=tile.innerHTML;
  inventory.push({id:tile.dataset.id,color:tile.dataset.color,tile:tile});
  checkMatch();
}

function checkMatch(){
  for(let i=0;i<inventory.length;i++){
    for(let j=i+1;j<inventory.length;j++){
      if(inventory[i].id===inventory[j].id && inventory[i].color===inventory[j].color){
        inventory[i].tile.classList.add('flipped');
        inventory[j].tile.classList.add('flipped');
        setTimeout(()=>{
          score+=200; scoreEl.innerText='Score: '+score;
          inventory[i].tile.remove(); inventory[j].tile.remove();
          inventoryEls[i].innerHTML=''; inventoryEls[j].innerHTML='';
          inventory.splice(j,1); inventory.splice(i,1);
        },300);
        return;
      }
    }
  }
  if(inventory.length===4){ alert('Ekwipunek pełny! Gra resetuje się.'); startGame('record'); }
}
</script>
</body>
</html>
