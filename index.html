<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahjong Neon</title>

<style>
html,body{
    margin:0;
    width:100%;
    height:100%;
    overflow:hidden;
    font-family:Arial,Helvetica,sans-serif;
    background:#5a3b1f;
}

#game{
    position:relative;
    width:100%;
    height:100%;
    background:radial-gradient(#7a4a25,#4a2c15);
}

/* ===== MENU ===== */
#menu{
    position:absolute;
    inset:0;
    background:rgba(0,0,0,.6);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    z-index:999;
}

#menu h1{
    color:white;
    margin-bottom:20px;
    text-shadow:0 0 10px #000;
}

.menu-btn{
    padding:14px 26px;
    margin:6px;
    font-size:18px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    background:#fff;
    box-shadow:0 0 10px #000;
}
.menu-btn:hover{transform:scale(1.05);}

/* ===== TILE ===== */
.tile{
    position:absolute;
    border-radius:14px;
    background:white;
    box-shadow:0 0 15px currentColor;
    transition:.25s;
    cursor:pointer;
}
.tile img{
    width:100%;
    height:100%;
    object-fit:contain;
}
.tile:hover{transform:scale(1.07);}

/* ===== INVENTORY ===== */
#inventory{
    position:absolute;
    bottom:10px;
    left:50%;
    transform:translateX(-50%);
    display:flex;
    gap:12px;
}
.inv-slot{
    width:70px;
    height:70px;
    background:white;
    border-radius:12px;
    box-shadow:0 0 10px #000;
    display:flex;
    align-items:center;
    justify-content:center;
}
.inv-slot img{width:90%;height:90%;}

/* ===== UI ===== */
#ui{
    position:absolute;
    top:10px;
    left:10px;
    color:white;
    font-size:18px;
    text-shadow:0 0 5px black;
}

#popup{
    position:absolute;
    top:45%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:36px;
    font-weight:bold;
    opacity:0;
    pointer-events:none;
    transition:.3s;
}
#popup.show{
    opacity:1;
    transform:translate(-50%,-60%);
}
</style>
</head>

<body>
<div id="game">

<div id="menu">
    <h1>MAHJONG NEON</h1>
    <button class="menu-btn" onclick="startLevel('easy')">Łatwy</button>
    <button class="menu-btn" onclick="startLevel('medium')">Średni</button>
    <button class="menu-btn" onclick="startLevel('hard')">Trudny</button>
    <button class="menu-btn" onclick="startLevel('extreme')">Ekstremalny</button>
    <button class="menu-btn" onclick="startLevel('pro')">Zawodowy</button>
    <button class="menu-btn" onclick="startLevel('random')">Klasyczny losowy</button>
</div>

<div id="ui">
    Score: <span id="score">0</span><br>
    Combo: <span id="combo">1</span><br>
    Time: <span id="time">0.0</span>s
</div>

<div id="popup"></div>

<div id="inventory">
    <div class="inv-slot"></div>
    <div class="inv-slot"></div>
    <div class="inv-slot"></div>
    <div class="inv-slot"></div>
</div>
</div>

<script>
const colors=[
 "#ff0033","#00e5ff","#ffee00","#00ff55",
 "#ff00ff","#00ffaa","#ff8800","#8888ff"
];

const LEVELS={
 easy:[3,2],
 medium:[4,3,2],
 hard:[5,4,3,2],
 extreme:[6,5,4,3],
 pro:[7,6,5,4,3],
 random:()=>Array.from({length:3+Math.random()*3},(_,i)=>5-i)
};

let layers=[],board=[],inventory=[];
let score=0,combo=1,lastPairTime=Date.now();

const game=document.getElementById("game");
const menu=document.getElementById("menu");
const scoreSpan=document.getElementById("score");
const comboSpan=document.getElementById("combo");
const timeSpan=document.getElementById("time");
const popup=document.getElementById("popup");

function startLevel(lvl){
 layers=typeof LEVELS[lvl]==="function"?LEVELS[lvl]():LEVELS[lvl];
 menu.style.display="none";
 generate();
}

function getScoreByTime(){
 const d=(Date.now()-lastPairTime)/1000;
 lastPairTime=Date.now();
 if(d<=1.4){show("YOU ARE THE LEGEND!","#ff00ff");return 500;}
 if(d<=3.5){show("IT'S IMPOSSIBLE!","#00e5ff");return 350;}
 if(d<=5){show("INSANE","#ff0033");return 250;}
 if(d<=7.5){show("AWESOME","#ffee00");return 150;}
 if(d<=10){show("NICE","#00ff55");return 100;}
 show("GOOD","#fff");return 50;
}

function show(t,c){
 popup.textContent=t;
 popup.style.color=c;
 popup.classList.add("show");
 setTimeout(()=>popup.classList.remove("show"),800);
}

function generate(){
 board=[];inventory=[];score=0;combo=1;
 lastPairTime=Date.now();

 let total=layers.reduce((a,b)=>a+b*b,0);
 let pool=[],img=1,col=0;
 while(pool.length<total){
  for(let i=0;i<2;i++) pool.push({img,col});
  col++;if(col>=colors.length){col=0;img++;if(img>16)img=1;}
 }
 pool.sort(()=>Math.random()-0.5);

 let i=0;
 layers.forEach((s,z)=>{
  for(let y=0;y<s;y++)
   for(let x=0;x<s;x++)
    board.push({x,y,z,img:pool[i].img,color:colors[pool[i++].col],removed:false});
 });
 render();
}

function isFree(t){
 if(t.removed) return false;
 if(board.some(o=>!o.removed&&o.z>t.z&&o.x===t.x&&o.y===t.y))return false;
 const l=board.some(o=>!o.removed&&o.z===t.z&&o.x===t.x-1&&o.y===t.y);
 const r=board.some(o=>!o.removed&&o.z===t.z&&o.x===t.x+1&&o.y===t.y);
 return !(l&&r);
}

function select(t){
 if(!isFree(t))return;
 inventory.push(t);t.removed=true;

 for(let i=0;i<inventory.length;i++)
  for(let j=i+1;j<inventory.length;j++)
   if(inventory[i].img===inventory[j].img&&inventory[i].color===inventory[j].color){
    inventory.splice(j,1);inventory.splice(i,1);
    score+=getScoreByTime()*combo;combo++;
    render();return;
   }

 if(inventory.length===4){alert("Ekwipunek pełny");menu.style.display="flex";}
 if(board.every(t=>t.removed)){alert("WYGRANA!");menu.style.display="flex";}
 render();
}

function render(){
 document.querySelectorAll(".tile").forEach(e=>e.remove());
 const max=Math.max(...layers);
 const screen=Math.min(innerWidth,innerHeight*.8);
 const size=Math.max(70,Math.min(screen/(max+1),140));

 board.forEach(t=>{
  if(t.removed)return;
  const d=document.createElement("div");
  d.className="tile";
  d.style.width=size+"px";
  d.style.height=size+"px";
  d.style.border="4px solid "+t.color;
  d.style.left=(innerWidth-screen)/2+(t.x+(max-t.z)/2)*size+"px";
  d.style.top=(innerHeight*.8-screen)/2+(t.y+(max-t.z)/2)*size+"px";
  const i=document.createElement("img");
  i.src=`assets/images/${t.img}.png`;
  d.appendChild(i);
  if(isFree(t)) d.onclick=()=>select(t); else d.style.opacity=.4;
  game.appendChild(d);
 });

 document.querySelectorAll(".inv-slot").forEach((s,i)=>{
  s.innerHTML="";
  if(inventory[i]){
   const im=document.createElement("img");
   im.src=`assets/images/${inventory[i].img}.png`;
   s.appendChild(im);
  }
 });

 scoreSpan.textContent=score;
 comboSpan.textContent=combo;
}

setInterval(()=>timeSpan.textContent=((Date.now()-lastPairTime)/1000).toFixed(1),100);
</script>
</body>
</html>




