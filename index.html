<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Case Opener</title>

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}

body{
    margin:0;
    padding:30px;
    background:radial-gradient(circle at top,#1c1f3a,#090a14);
    color:#fff;
    display:flex;
    flex-direction:column;
    align-items:center;
}

/* ===== UI ===== */
h1{margin-bottom:10px}
.balance{font-size:22px;color:gold;margin-bottom:25px}
.hidden{display:none}

button{
    padding:12px 26px;
    border:none;
    border-radius:12px;
    background:linear-gradient(45deg,#ffcc00,#ff9500);
    font-weight:bold;
    cursor:pointer;
}
button:disabled{opacity:.5}

/* ===== LOBBY ===== */
#lobby{
    width:100%;
    max-width:1100px;
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:20px;
}

.case-card{
    background:#0f1225;
    padding:20px;
    border-radius:18px;
    text-align:center;
    box-shadow:0 0 25px rgba(0,0,0,.5);
}

/* ===== CASE OPEN ===== */
.case-window{
    width:920px;
    height:220px;
    background:#0c0f22;
    border-radius:20px;
    overflow:hidden;
    position:relative;
    margin-bottom:20px;
}

.pointer{
    position:absolute;
    left:50%;
    top:0;
    width:4px;
    height:100%;
    background:linear-gradient(#ffd700,#ff9c00);
    transform:translateX(-50%);
    z-index:5;
}

.tape{
    height:100%;
    display:flex;
    align-items:center;
    gap:16px;
    padding:0 450px;
    transition:transform 6s cubic-bezier(.15,.75,.15,1);
}

/* ===== ITEM ===== */
.item{
    width:140px;
    height:140px;
    background:#05060f;
    border-radius:18px;
    display:flex;
    align-items:center;
    justify-content:center;
    flex-shrink:0;
}

.item img{
    width:85%;
    height:85%;
    object-fit:contain;
}

/* ===== RARITY ===== */
.common{border:4px solid #666}
.rare{border:4px solid #2aa7ff;box-shadow:0 0 18px #2aa7ff}
.epic{border:5px solid #b14cff;box-shadow:0 0 24px #b14cff}
.mythic{border:6px solid #ff3333;box-shadow:0 0 30px #ff3333}
.legendary{
    border:6px solid gold;
    box-shadow:0 0 30px gold,0 0 60px rgba(255,215,0,.6)
}

/* ===== RESULT ===== */
.result{
    display:flex;
    align-items:center;
    gap:25px;
    margin-top:20px;
}

.price{font-size:28px;color:gold}
.controls{display:flex;gap:15px}
</style>
</head>

<body>

<h1>üéÅ Case Opener</h1>
<div class="balance">üí∞ Saldo: <span id="balance">0.00</span> $</div>

<div id="lobby"></div>

<div id="game" class="hidden">
    <div class="case-window">
        <div class="pointer"></div>
        <div class="tape" id="tape"></div>
    </div>

    <div class="controls">
        <button id="openBtn">OTW√ìRZ</button>
        <button onclick="back()">‚¨Ö POWR√ìT</button>
    </div>

    <div class="result" id="result"></div>
</div>

<audio id="clickSound" src="assets/sounds/click.mp3"></audio>
<audio id="dropSound" src="assets/sounds/drop.mp3"></audio>

<script>
/* ===== IMAGES ===== */
const images = Array.from({length:16},(_,i)=>({
    src:`assets/images/${i+1}.png`,
    value:+(1 + i*0.1).toFixed(1)
}));

/* ===== MULTIPLIERS ===== */
const MULT = {
    common:1,
    rare:5,
    epic:15,
    mythic:60,
    legendary:1000
};

/* ===== CASES ===== */
const cases = [
{
    name:"Normal Case",
    price:0,
    chances:[
        {r:"common",p:99},
        {r:"rare",p:0.9},
        {r:"epic",p:0.1}
    ]
},
{
    name:"Bronze Case",
    price:1,
    chances:[
        {r:"common",p:95},
        {r:"rare",p:4},
        {r:"epic",p:1}
    ]
},
{
    name:"Classic Case",
    price:3,
    chances:[
        {r:"common",p:70},
        {r:"rare",p:25},
        {r:"epic",p:4},
        {r:"mythic",p:1}
    ]
},
{
    name:"Silver Case",
    price:12,
    chances:[
        {r:"common",p:50},
        {r:"rare",p:30},
        {r:"epic",p:15},
        {r:"mythic",p:5}
    ]
},
{
    name:"Golden Case",
    price:20,
    chances:[
        {r:"common",p:30},
        {r:"rare",p:30},
        {r:"epic",p:30},
        {r:"mythic",p:9.5},
        {r:"legendary",p:0.5}
    ]
},
{
    name:"God Case",
    price:100,
    chances:[
        {r:"epic",p:50},
        {r:"mythic",p:45},
        {r:"legendary",p:5}
    ]
}
];

/* ===== STATE ===== */
let balance = 0;
let active = null;
let opened = false;

const lobby = document.getElementById("lobby");
const game = document.getElementById("game");
const tape = document.getElementById("tape");
const result = document.getElementById("result");
const balanceEl = document.getElementById("balance");
const openBtn = document.getElementById("openBtn");

/* ===== LOBBY BUILD ===== */
cases.forEach((c,i)=>{
    lobby.innerHTML += `
    <div class="case-card">
        <h3>${c.name}</h3>
        <p>${c.price}$</p>
        <button onclick="enter(${i})">KUP</button>
    </div>`;
});

function enter(i){
    if(balance < cases[i].price) return alert("Brak ≈õrodk√≥w");
    balance -= cases[i].price;
    balanceEl.textContent = balance.toFixed(2);

    active = cases[i];
    opened = false;
    openBtn.disabled = false;

    lobby.classList.add("hidden");
    game.classList.remove("hidden");
    result.innerHTML="";
}

function back(){
    game.classList.add("hidden");
    lobby.classList.remove("hidden");
}

/* ===== RNG ===== */
function rollRarity(){
    let r = Math.random()*100, sum = 0;
    for(const c of active.chances){
        sum += c.p;
        if(r <= sum) return c.r;
    }
}

function rollItem(){
    const img = images[Math.floor(Math.random()*images.length)];
    const rar = rollRarity();
    return {img,rar};
}

/* ===== OPEN CASE ===== */
openBtn.onclick = () => {
    if(opened) return;
    opened = true;
    openBtn.disabled = true;

    document.getElementById("clickSound").play();

    tape.style.transition="none";
    tape.style.transform="translateX(0)";
    tape.innerHTML="";

    const items=[];
    for(let i=0;i<40;i++){
        const it=rollItem();
        items.push(it);
        const d=document.createElement("div");
        d.className=`item ${it.rar}`;
        d.innerHTML=`<img src="${it.img.src}">`;
        tape.appendChild(d);
    }

    const winIndex = 28;
    const winItem = items[winIndex];

    setTimeout(()=>{
        tape.style.transition="transform 6s cubic-bezier(.15,.75,.15,1)";
        tape.style.transform=`translateX(-${winIndex*156}px)`;
    },50);

    setTimeout(()=>{
        document.getElementById("dropSound").play();
        const price = +(winItem.img.value * MULT[winItem.rar]).toFixed(2);

        result.innerHTML = `
            <div class="item ${winItem.rar}">
                <img src="${winItem.img.src}">
            </div>
            <div class="price">${price}$</div>
        `;

        balance += price;
        balanceEl.textContent = balance.toFixed(2);
    },6200);
};
</script>

</body>
</html>
