<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahjong Pyramid Pro FIX</title>
<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.6)),
  url('https://images.unsplash.com/photo-1601758125946-6ec2ef64daf8?q=80&w=1200');
  background-size:cover;
  background-position:center;
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
}

#menu,#game{
  width:100vw;
  max-width:1200px;
  text-align:center;
}

#menu button{
  margin:8px;
  padding:14px 24px;
  font-size:1.1rem;
  border:none;
  border-radius:10px;
  background:#222;
  color:#fff;
  cursor:pointer;
}

#menu button:hover{
  background:#00e5ff;
  color:#000;
}

.board{
  position:relative;
  width:95vmin;
  height:95vmin;
  margin:20px auto;
}

.tile{
  position:absolute;
  border-radius:10px;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#ffffff;
  transition:all .25s ease;
}

.tile img{
  width:80%;
  height:80%;
  object-fit:contain;
}

.tile:hover{
  transform:scale(1.08);
  box-shadow:0 0 25px currentColor;
}

#inventory{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-bottom:30px;
}

.slot{
  width:60px;
  height:60px;
  background:#fff;
  border:3px solid #00e5ff;
  border-radius:8px;
  display:flex;
  justify-content:center;
  align-items:center;
}

#score{
  font-size:1.4rem;
  margin-top:10px;
}
</style>
</head>
<body>

<div id="menu">
<h1>Mahjong Pyramid</h1>
<p>Wybierz poziom:</p>
<button data-level="pro">Zawodowy</button>
<button data-level="extreme">Ekstremalny</button>
<button data-level="hard">Trudny</button>
<button data-level="medium">Średni</button>
<button data-level="classic">Klasyczny</button>
<button data-level="easy">Łatwy</button>
</div>

<div id="game" style="display:none;">
<div id="score">Score: 0</div>
<div class="board" id="board"></div>
<div id="inventory">
<div class="slot"></div>
<div class="slot"></div>
<div class="slot"></div>
<div class="slot"></div>
</div>
</div>

<script>
const levels={
  pro:[7,6,5,4,3],
  extreme:[6,5,4,3],
  hard:[5,4,3,2],
  medium:[4,3,2],
  easy:[3,2]
};

let inventory=[];
let score=0;
const board=document.getElementById("board");
const slots=document.querySelectorAll(".slot");
const scoreEl=document.getElementById("score");

// START

document.querySelectorAll("#menu button").forEach(btn=>{
  btn.onclick=()=>{
    document.getElementById("menu").style.display="none";
    document.getElementById("game").style.display="block";
    setTimeout(()=>startGame(btn.dataset.level),50);
  }
});

function startGame(level){
  board.innerHTML="";
  inventory=[];
  score=0;
  scoreEl.innerText="Score: 0";
  slots.forEach(s=>s.innerHTML="");

  let layers = level==="classic" ? randomLayers() : levels[level];

  let maxSize=Math.max(...layers);
  let tileSize=Math.floor(board.clientWidth/(maxSize+1));

  let colors=["#ff3b3b","#00e5ff","#ffff00","#00ff6a","#ff00ff","#ff8800","#00ffff","#7dff00","#ff0088","#0088ff","#ff4444","#44ff44","#4444ff"];

  let tiles=[];
  let id=0;

  layers.forEach(size=>{
    for(let i=0;i<size*size/2;i++){
      let color=colors[(id+i)%colors.length];
      tiles.push({id:id,img:`https://via.placeholder.com/100?text=${id+1}`,color});
      tiles.push({id:id,img:`https://via.placeholder.com/100?text=${id+1}`,color});
      id++;
    }
  });

  tiles.sort(()=>Math.random()-0.5);

  let index=0;
  layers.forEach((size,layerIndex)=>{
    let offsetX=(board.clientWidth-size*tileSize)/2;
    let offsetY=layerIndex*(tileSize/2);

    for(let r=0;r<size;r++){
      for(let c=0;c<size;c++){
        if(index>=tiles.length) return;

        let t=tiles[index];
        let div=document.createElement("div");
        div.className="tile";
        div.style.width=tileSize+"px";
        div.style.height=tileSize+"px";
        div.style.left=(offsetX+c*tileSize)+"px";
        div.style.top=(offsetY+r*tileSize)+"px";
        div.style.border="4px solid "+t.color;
        div.style.color=t.color;
        div.dataset.id=t.id;
        div.innerHTML=`<img src="${t.img}">`;
        div.onclick=()=>pick(div);
        board.appendChild(div);
        index++;
      }
    }
  });
}

function randomLayers(){
  let count=Math.floor(Math.random()*3)+2;
  let arr=[];
  for(let i=0;i<count;i++){
    arr.push(Math.floor(Math.random()*5)+2);
  }
  return arr;
}

function pick(tile){
  if(inventory.length>=4){
    alert("Ekwipunek pełny — reset!");
    startGame("pro");
    return;
  }

  tile.style.visibility="hidden";
  slots[inventory.length].innerHTML=tile.innerHTML;
  inventory.push(tile);

  checkMatch();
}

function checkMatch(){
  for(let i=0;i<inventory.length;i++){
    for(let j=i+1;j<inventory.length;j++){
      if(inventory[i].dataset.id===inventory[j].dataset.id){
        inventory[i].remove();
        inventory[j].remove();
        inventory=[];
        slots.forEach(s=>s.innerHTML="");
        score+=200;
        scoreEl.innerText="Score: "+score;
        return;
      }
    }
  }
}
</script>
</body>
</html>
